<!doctype html>
<html>
  <head>
    <title>Netflix - Interactive Analysis</title>

    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
      }
  
      .chart {
        width: 1000px;
        height: 1000px;
        background-color: #f7f7f7;
        border: 1px solid #ccc;
        border: 1px solid #f7f7f7;
        display: none;
      }

      
  
      .active {
        display: block;
      }
  
      .button-container {
        margin-bottom: 10px;
      }
  
      .button {
        padding: 10px 20px;
        font-size: 16px;
        font-weight: bold;
        border: none;
        border-radius: 5px;
        background-color: #4CAF50;
        color: #fff;
        cursor: pointer;
        margin-right: 10px;
      }
    </style>


  </head>
  <body>
    <h1 class="display-4"> Let's explore Netflix!</h1>
    <div class="button-container">
      <button class="button" onclick="showChart(1)">1</button>
      <button class="button" onclick="showChart(2)">2</button>
      <button class="button" onclick="showChart(3)">3</button>
      <button class="button" onclick="showChart(4)">4</button>
    </div>
    <div class="chart" id="chart1"></div>
    <div class="chart" id="chart2"></div>
    <div class="chart" id="chart3"></div>
    <div class="chart" id="chart4"></div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>
    // Show the specified chart based on the button click
    function showChart(chartNumber) {
      // Hide all charts
      d3.selectAll('.chart').style('display', 'none');

      // Show the selected chart
      const selectedChart = d3.select(`#chart${chartNumber}`);
      selectedChart.style('display', 'block');

      // Generate the chart content based on the selected chart number
      generateChartContent(selectedChart, chartNumber);
    }

    // Generate the content for each chart based on the chart number
    function generateChartContent(chart, chartNumber) {
      // Clear existing content
      chart.html('');


      // Generate content based on the chart number
      switch (chartNumber) {
        case 1:
          //chart.append('p').text('Pie Chart');

          d3.csv("netflix_data.csv").then(function(data) {
  const categoryCounts = {};

  // Count the occurrences of each category
  data.forEach(function(d) {
    const categories = d.listed_in.split(", ");
    categories.forEach(function(category) {
      categoryCounts[category] = (categoryCounts[category] || 0) + 1;
    });
  });

  // Convert counts object to an array of objects
  const formattedData = Object.keys(categoryCounts).map(function(category) {
    return { category: category, count: categoryCounts[category] };
  });

  // Log the formatted data to the console
  console.log(formattedData);

    // Set up the bubble chart
    const width = 600;
    const height = 600;
    const svg = d3.select("#chart1")
      .append("svg")
      .attr("width", width)
      .attr("height", height);

    const color = d3.scaleOrdinal(d3.schemeCategory10);

    const pack = data => d3.pack()
      .size([width, height])
      .padding(3)
      (d3.hierarchy({ children: data })
        .sum(d => d.count));

    const root = pack(data);

    const node = svg.selectAll("circle")
      .data(root.leaves())
      .join("circle")
      .attr("class", "node")
      .attr("cx", d => d.x)
      .attr("cy", d => d.y)
      .attr("r", d => d.r)
      .attr("fill", d => color(d.data.category))
      .on("mouseover", function (event, d) {
        d3.select(this).attr("fill", "#ff7f0e");
        tooltip.style("opacity", 1)
          .html(`${d.data.category}: ${d.data.count}`)
          .style("left", (d3.event.pageX + 10) + "px")
          .style("top", (d3.event.pageY + 10) + "px");
      })
      .on("mouseout", function (event, d) {
        d3.select(this).attr("fill", d => color(d.data.category));
        tooltip.style("opacity", 0);
      });

    // Add labels to the bubbles
    const labels = svg.selectAll("text")
      .data(root.leaves())
      .join("text")
      .attr("class", "label")
      .attr("x", d => d.x)
      .attr("y", d => d.y)
      .attr("text-anchor", "middle")
      .attr("dominant-baseline", "middle")
      .attr("fill", "#000")
      .style("font-size", "12px")
      .text(d => d.data.category);

    // Add tooltip element
    const tooltip = d3.select("body")
      .append("div")
      .attr("class", "tooltip")
      .style("opacity", 0);
          

    });
    break;
          
        case 2:
          chart.append('p').text('Content Over the Years');
          break;
        case 3:
          chart.append('p').text('Content from different countries');
          break;
        case 4:
          chart.append('p').text('Top Categories');
          break;
        default:
          chart.append('p').text('No chart content available');
      }
    }
  </script>
  </body>
</html>